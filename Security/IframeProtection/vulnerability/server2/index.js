import express from "express";
import { fileURLToPath } from "node:url";
import { dirname, join } from "node:path";

const app = express();
const PORT = process.env.port || 5112;

const __dirname = dirname(fileURLToPath(import.meta.url));

// mitigation using frame-ancestors
// throws below error if any tries to access the encpoints
// Framing 'http://localhost:5112/' violates the following Content Security Policy directive: "frame-ancestors 'none'". The request has been blocked.
app.use((req, res, next) => {
  res.setHeader("Content-Security-Policy", "frame-ancestors 'none'");
  next();
});

app.get("/iframe-website1", (req, res) => {
  res.sendFile(join(__dirname, "iframe-website1.html"));
});

app.get("/iframe-website2", (req, res) => {
  res.sendFile(join(__dirname, "iframe-website2.html"));
});

app.listen(PORT, () => {
  console.log("Server is running at", PORT);
});
